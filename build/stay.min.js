/**
 * stay v0.1.10 build Dec 04 2015
 * https://github.com/vanruesc/stay
 * Copyright 2015 Raoul van RÃ¼schen, Apache-2.0
 */
var STAY=function(){"use strict";function a(){this._listeners={}}function b(a){var b=document.createElement("a");return b.href=a,b.pathname}function c(b){var d=this;if(a.call(this),this.local=new RegExp("^"+location.protocol+"//"+location.host),this.exclusions=[],this.stderr=null,this.infix="/json",this.timeoutPost=6e4,this.timeoutGet=5e3,this.autoUpdate=!0,void 0!==b&&(void 0!==b.stderr&&(this.stderr=b.stderr),void 0!==b.infix&&(this.infix=b.infix),void 0!==b.timeoutPost&&(this.timeoutPost=b.timeoutPost),void 0!==b.timeoutGet&&(this.timeoutGet=b.timeoutGet),void 0!==b.autoUpdate&&(this.autoUpdate=b.autoUpdate)),this.locked=!1,this.backForward=!1,this.absolutePath=null,this.historyState=null,this.containers=[],this.intermediateContainer=null,this.navigationListeners=[],this.eventNavigate={type:"navigate"},this.eventReceive={type:"receive",response:null,status:0},this.eventLoad={type:"load"},void 0===XMLHttpRequest)throw new Error("XMLHttpRequest is not supported.");switch(this.xhr=new XMLHttpRequest,this.xhr.addEventListener("error",function(a){d.dispatchEvent(a)}),this.xhr.addEventListener("readystatechange",function(a){d._handleResponse(this,a)}),this.xhr.addEventListener("timeout",function(){var a={meta:{}};a.meta.title="Timeout Error",null!==d.stderr?a[d.stderr]="<p>"+c.Error.TIMEOUT+"</p>":console.error(c.Error.TIMEOUT),d.locked=!0,d.update(a)}),window.addEventListener("popstate",function(a){d.locked||null===a.state||(d.backForward=!0,d._navigate({href:a.state.url}))}),this._switchPage=function(a){var b=void 0!==a.preventDefault,c=!1;return"submit"===a.type?c=!0:a.metaKey||a.shiftKey||a.altKey||a.ctrlKey||(void 0!==a.which?c=1===a.which:void 0!==a.button&&(c=0===a.button)),c&&(b&&a.preventDefault(),d.locked||d._navigate(a.target)),!(c&&!b)},this.update({meta:{title:document.title,url:location.href}}),document.readyState){case"loading":document.addEventListener("DOMContentLoaded",function e(){document.removeEventListener("DOMContentLoaded",e),d._updateListeners()});break;default:this._updateListeners()}}return a.prototype.apply=function(b){b._listeners={},b.addEventListener=a.prototype.addEventListener,b.hasEventListener=a.prototype.hasEventListener,b.removeEventListener=a.prototype.removeEventListener,b.dispatchEvent=a.prototype.dispatchEvent},a.prototype.addEventListener=function(a,b){void 0===this._listeners[a]&&(this._listeners[a]=[]),-1===this._listeners[a].indexOf(b)&&this._listeners[a].push(b)},a.prototype.hasEventListener=function(a,b){return void 0!==this._listeners[a]&&-1!==this._listeners[a].indexOf(b)},a.prototype.removeEventListener=function(a,b){var c,d;d=this._listeners[a],void 0!==d&&(c=d.indexOf(b),-1!==c&&d.splice(c,1))},a.prototype.dispatchEvent=function(a){var b,c,d;if(d=this._listeners[a.type],void 0!==d)for(a.target=this,b=0,c=d.length;c>b;++b)d[b].call(this,a)},c.prototype=Object.create(a.prototype),c.prototype.constructor=c,c.prototype._navigate=function(a){var c,d,e,f=!1;this.locked=!0,a.action?(this.absolutePath=a.action,c=new FormData(a),f=!0):this.absolutePath=a.href,d=b(this.absolutePath),"/"!==d.charAt(0)&&(d="/"+d),e="/"===d?this.absolutePath.slice(0,this.absolutePath.length-1)+this.infix+d:this.absolutePath.replace(new RegExp(d),this.infix+d),this.eventNavigate.method=f?"POST":"GET",this.dispatchEvent(this.eventNavigate);try{this.xhr.open(this.eventNavigate.method,e,!0),f?(this.xhr.timeout=this.timeoutPost,this.xhr.send(c)):(this.xhr.timeout=this.timeoutGet,this.xhr.send())}catch(g){this.dispatchEvent(g)}},c.prototype._updateView=function(a){var b,d,e,f=!1;if(null===this.intermediateContainer)this.intermediateContainer=document.createElement("div");else for(;this.intermediateContainer.children.length>0;)this.intermediateContainer.removeChild(this.intermediateContainer.children[0]);for(b in a)if(e=a[b],"object"!=typeof e)if(d=this.containers[b],void 0===d&&(d=this.containers[b]=document.getElementById(b)),null!==d){for(;d.children.length>0;)d.removeChild(d.children[0]);for(this.intermediateContainer.innerHTML=e;this.intermediateContainer.children.length>0;)d.appendChild(this.intermediateContainer.children[0]);f=!0}else console.warn(c.Error.NO_CONTAINER,b);f&&this._updateListeners()},c.prototype.unbindListeners=function(){for(var a,b=this;this.navigationListeners.length>0;)a=this.navigationListeners.pop(),a[0].removeEventListener(a[1],b._switchPage)},c.prototype._updateListeners=function(){var a,b,c,d,e,f=this,g=document.getElementsByTagName("a"),h=document.getElementsByTagName("form");for(this.unbindListeners(),a=0,c=g.length;c>a;++a)if(this.local.test(g[a].href)){for(b=0,d=this.exclusions.length,e=!1;!e&&d>b;++b)this.exclusions[b].test(g[a].href)&&(e=!0);e||(g[a].addEventListener("click",f._switchPage),this.navigationListeners.push([g[a],"click"]))}for(a=0,c=h.length;c>a;++a)if(this.local.test(h[a].action)){for(b=0,d=this.exclusions.length,e=!1;!e&&d>b;++b)this.exclusions[b].test(h[a].action)&&(e=!0);e||(h[a].addEventListener("submit",f._switchPage),this.navigationListeners.push([h[a],"submit"]))}},c.prototype.update=function(a){var b;if(this._updateView(a),document.title=a.meta.title,a.meta.url&&(this.absolutePath=a.meta.url.replace(this.infix,"")),this.backForward)this.backForward=!1;else if(null===this.historyState||this.absolutePath!==this.historyState.url?this.historyState={url:this.absolutePath,time:Date.now(),changed:!0}:this.historyState.changed=!1,b=document.origin?document.origin:document.defaultView.location.origin?document.defaultView.location.origin:"null","null"!==b)try{this.historyState.changed?history.pushState(this.historyState,a.meta.title,this.absolutePath):history.replaceState(this.historyState,a.meta.title,this.absolutePath)}catch(c){console.warn(c)}this.eventReceive.response=null,this.dispatchEvent(this.eventLoad),this.locked=!1},c.prototype._handleResponse=function(a){var b={meta:{}};if(4===a.readyState){try{b=JSON.parse(a.responseText)}catch(d){b.meta.title="Parse Error",null!==this.stderr&&(b[this.stderr]="<p>"+c.Error.UNPARSABLE+"</p>"),console.error(c.Error.UNPARSABLE)}b.meta.url=a.responseURL,this.eventReceive.status=a.status,this.eventReceive.response=b,this.dispatchEvent(this.eventReceive),this.autoUpdate&&this.update(b)}},c.Error=Object.freeze({TIMEOUT:"The server didn't respond in time. Please try again later!",UNPARSABLE:"The received content could not be parsed.",NO_CONTAINER:"Couldn't find a container for:"}),c}();